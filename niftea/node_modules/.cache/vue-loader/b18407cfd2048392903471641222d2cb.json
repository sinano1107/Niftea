{"remainingRequest":"/Users/choumasateru/Desktop/development_direction/vue/niftea/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/choumasateru/Desktop/development_direction/vue/niftea/src/components/IssueNumber.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/choumasateru/Desktop/development_direction/vue/niftea/src/components/IssueNumber.vue","mtime":1578226723248},{"path":"/Users/choumasateru/Desktop/development_direction/vue/niftea/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/choumasateru/Desktop/development_direction/vue/niftea/node_modules/vuetify-loader/lib/loader.js","mtime":1574476662000},{"path":"/Users/choumasateru/Desktop/development_direction/vue/niftea/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/choumasateru/Desktop/development_direction/vue/niftea/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBmaXJlYmFzZSBmcm9tICdmaXJlYmFzZS9hcHAnCmltcG9ydCAnZmlyZWJhc2UvZGF0YWJhc2UnCmltcG9ydCAnZmlyZWJhc2Uvc3RvcmFnZScKaW1wb3J0IE5hdmlnYXRpb25EcmF3ZXIgZnJvbSAnLi9OYXZpZ2F0aW9uRHJhd2VyJwppbXBvcnQgSW5kZXRlcm1pbmF0ZSBmcm9tICcuL0luZGV0ZXJtaW5hdGUnCmltcG9ydCBOb3dTZWF0V3JhcENhcmQgZnJvbSAnLi9Ob3dTZWF0V3JhcENhcmQnCgpleHBvcnQgZGVmYXVsdCB7CiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGxvYWRpbmc6IHRydWUsCiAgICAgIHNob3c6IGZhbHNlLAogICAgICBoYXZlTnVtYmVyOiBmYWxzZSwKICAgICAgYXR0ZW5kYW5jZTogZmFsc2UsIC8vIOeZu+agoea4iOOBv+OBi+OBqeOBhuOBiwogICAgICBteU51bWJlcjogJycsCiAgICAgIHJlYWxOYW1lOiAnJywKICAgICAgc25hY2tiYXI6IGZhbHNlCiAgICB9CiAgfSwKICBjb21wb25lbnRzOiB7CiAgICBOYXZpZ2F0aW9uRHJhd2VyLAogICAgSW5kZXRlcm1pbmF0ZSwKICAgIE5vd1NlYXRXcmFwQ2FyZAogIH0sCiAgY3JlYXRlZCgpIHsKICAgIHRoaXMuaW5pdCgpCiAgfSwKICBtZXRob2RzOiB7CiAgICBhc3luYyBpbml0KCkgewogICAgICBsZXQgYXR0ZW5kYW5jZURhdGEgPSBhd2FpdCB0aGlzLmdldEF0dGVuZGFuY2VEYXRhKCkKICAgICAgY29uc29sZS5kZWJ1ZyhhdHRlbmRhbmNlRGF0YSkKICAgICAgaWYgKGF3YWl0IHRoaXMuc2VhcmNoTXlOdW1iZXIoYXR0ZW5kYW5jZURhdGEpKSB7CiAgICAgICAgY29uc29sZS5kZWJ1Zygi6Ieq5YiG44Gu55Wq5Y+344GM5a2Y5Zyo44GX44G+44GX44GfIikKICAgICAgICB0aGlzLmhhdmVOdW1iZXIgPSB0cnVlCiAgICAgICAgbGV0IG15TnVtYmVyID0gYXdhaXQgdGhpcy5nZXRNeU51bWJlckRhdGEoYXR0ZW5kYW5jZURhdGEpCiAgICAgICAgdGhpcy5teU51bWJlciA9IG15TnVtYmVyCiAgICAgIH0gZWxzZSBpZiAoYXdhaXQgdGhpcy5zZWFyY2hNeXVpZE5vdygpKSB7CiAgICAgICAgY29uc29sZS5kZWJ1Zygi44GK5YmN44KC44GG5a2m5qCh44GK44KL44KE44KT44GRIikKICAgICAgICB0aGlzLmF0dGVuZGFuY2UgPSB0cnVlCiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29uc29sZS5kZWJ1Zygi6Ieq5YiG44Gu55Wq5Y+344GM44GC44KK44G+44Gb44KT44Gn44GX44GfIikKICAgICAgfQoKICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2UKCiAgICB9LAogICAgZ2V0QXR0ZW5kYW5jZURhdGEoKSB7IC8vIGF0dGVuZGFuY2Xjga7jg4fjg7zjgr/jgpLpgKPmg7PphY3liJfjgafjgajjgaPjgabjgY/jgosKICAgICAgbGV0IGRhdGFiYXNlID0gZmlyZWJhc2UuZGF0YWJhc2UoKQogICAgICBsZXQgYXR0ZW5kYW5jZSA9IGRhdGFiYXNlLnJlZignYXR0ZW5kYW5jZScpCiAgICAgIGxldCBzZWxmID0gdGhpcwogICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSkgewogICAgICAgIGF0dGVuZGFuY2Uub24oJ3ZhbHVlJywgKHNuYXBzaG90KT0+IHsKICAgICAgICAgIGxldCB2YWwgPSBzbmFwc2hvdC52YWwoKQogICAgICAgICAgZGVsZXRlIHZhbFsnbmlsJ10gLy8g56m644OH44O844K/44Gu5YmK6ZmkCiAgICAgICAgICBzZWxmLmF0dGVuZGFuY2VEYXRhID0gdmFsCiAgICAgICAgICByZXNvbHZlKHZhbCkKICAgICAgICB9KQogICAgICB9KQogICAgfSwKICAgIHNlYXJjaE15TnVtYmVyKGF0dGVuZGFuY2VEYXRhKSB7IC8vIGF0dGVuZGFuY2VEYXRh44Gu44Gq44GL44Gr6Ieq5YiG44Gu55Wq5Y+344GM44GC44KL44GL44GX44KJ44G544KLCiAgICAgIGxldCBteVVpZCA9IGZpcmViYXNlLmF1dGgoKS5jdXJyZW50VXNlci51aWQKCiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlKSB7CiAgICAgICAgZm9yIChsZXQga2V5IGluIGF0dGVuZGFuY2VEYXRhKSB7CiAgICAgICAgICBpZiAoYXR0ZW5kYW5jZURhdGFba2V5XVsndWlkJ10gPT0gbXlVaWQpIHsKICAgICAgICAgICAgcmVzb2x2ZSh0cnVlKQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXNvbHZlKGZhbHNlKQogICAgICB9KQogICAgfSwKICAgIHNlYXJjaE15dWlkTm93KCkgeyAvLyDku4rjga7luK0obm93KeOBruODh+ODvOOCv+OBq+iHquWIhuOBrnVpZOOBjOWtmOWcqOOBmeOCi+OBi+iqv+OBueOCiyjnmbvmoKHmuIjjgb/jgYvjgZfjgonjgbnjgospCiAgICAgIGxldCBkYXRhYmFzZSA9IGZpcmViYXNlLmRhdGFiYXNlKCkKICAgICAgbGV0IG15VWlkID0gZmlyZWJhc2UuYXV0aCgpLmN1cnJlbnRVc2VyLnVpZAoKICAgICAgLy8gTm9344Gu5Y+W5b6XCiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlKSB7CiAgICAgICAgbGV0IG5vdyA9IGRhdGFiYXNlLnJlZignL3NlYXRzL05vdycpCiAgICAgICAgbm93Lm9uKCd2YWx1ZScsIChzbmFwc2hvdCk9PiB7CiAgICAgICAgICBsZXQgdmFsID0gc25hcHNob3QudmFsKCkKICAgICAgICAgIGxldCBhbnN3ZXIgPSBmYWxzZQoKICAgICAgICAgIC8vIOaknOe0ouOBi+OBhOOBlwogICAgICAgICAgc2VhcmNoX2xvb3A6CiAgICAgICAgICBmb3IgKGxldCBpPTA7IGk8MTU7IGkrKykgewogICAgICAgICAgICBmb3IgKGxldCBqPTA7IGo8NjsgaisrKSB7CiAgICAgICAgICAgICAgaWYgKHZhbFtpXVtqXSA9PSBteVVpZCkgewogICAgICAgICAgICAgICAgYW5zd2VyID0gdHJ1ZQogICAgICAgICAgICAgICAgYnJlYWsgc2VhcmNoX2xvb3AKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIHJlc29sdmUoYW5zd2VyKQogICAgICAgIH0pCiAgICAgIH0pCiAgICB9LAogICAgYXN5bmMgbWFrZU51bWJlcigpIHsgLy8g6Ieq5YiG44Gu55Wq5Y+344KS5L2c44KLCiAgICAgIC8vIOS7iuOBrueVquWPt+S4gOimp+OBqOiiq+OCieOBquOBhOS5seaVsOOCkuS9nOOCiwogICAgICBsZXQgYXR0ZW5kYW5jZURhdGEgPSBhd2FpdCB0aGlzLmdldEF0dGVuZGFuY2VEYXRhKCkKICAgICAgbGV0IHJhbmRvbSA9IDAKICAgICAgbGV0IGxvb3AgPSB0cnVlCiAgICAgIHdoaWxlIChsb29wKSB7CiAgICAgICAgbGV0IGJyYW5jaCA9IHRydWUKICAgICAgICByYW5kb20gPSBNYXRoLmZsb29yKCBNYXRoLnJhbmRvbSgpICogOTAwMDAwICkgKyAxMDAwMDA7IC8vIDEwMDAwMH45OTk5OTnjga7kubHmlbDjgpLnlJ/miJAKICAgICAgICBmb3IgKGxldCBrZXkgaW4gYXR0ZW5kYW5jZURhdGEpIHsKICAgICAgICAgIGlmIChyYW5kb20gPT0ga2V5KSB7CiAgICAgICAgICAgIGJyYW5jaCA9IGZhbHNlCiAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmIChicmFuY2gpIHsKICAgICAgICAgIC8vIOmHjeOBquOCieOBquOBi+OBo+OBn+aZguOBruWHpueQhgogICAgICAgICAgdGhpcy5zZXROdW1iZXIocmFuZG9tKQogICAgICAgICAgbG9vcCA9IGZhbHNlCiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgYXN5bmMgc2V0TnVtYmVyKG51bWJlcikgeyAvLyDnlarlj7fjga7oqK3lrprplqLmlbAKICAgICAgbGV0IHNlbGYgPSB0aGlzCiAgICAgIGNvbnNvbGUuZGVidWcoInNldE51bWJlciIsbnVtYmVyKQogICAgICBsZXQgc2VhdCA9IGF3YWl0IHRoaXMuc2VhcmNoTXlSZXNlcnZhdGlvbigpCiAgICAgIGlmIChzZWF0ID09ICLpnZ7nmbvmoKHml6UiKSB7CiAgICAgICAgdGhpcy5zbmFja2JhciA9IHRydWUKICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zb2xlLmRlYnVnKHNlYXQpCgogICAgICAgIC8vIDHliIblvozjga7mmYLplpPjgpLnlJ/miJAKICAgICAgICBsZXQgdGltZUxpbWl0ID0gbmV3IERhdGUoKQogICAgICAgIHRpbWVMaW1pdC5zZXRNaW51dGVzKHRpbWVMaW1pdC5nZXRNaW51dGVzKCkgKyAxKQogICAgICAgIGNvbnNvbGUuZGVidWcoJ3RpbWVMaW1pdCcsIHRpbWVMaW1pdCkKCiAgICAgICAgbGV0IGRhdGFiYXNlID0gZmlyZWJhc2UuZGF0YWJhc2UoKQoKICAgICAgICBsZXQgcmVzdWx0ID0gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSkgewogICAgICAgICAgZGF0YWJhc2UucmVmKGBhdHRlbmRhbmNlLyR7bnVtYmVyfWApLnNldCh7J3VpZCc6IGZpcmViYXNlLmF1dGgoKS5jdXJyZW50VXNlci51aWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnc2VhdCc6IHNlYXQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAndGltZUxpbWl0Jzoge0hvdXJzOiB0aW1lTGltaXQuZ2V0SG91cnMoKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTWludXRlczogdGltZUxpbWl0LmdldE1pbnV0ZXMoKX0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgcmVzb2x2ZSgpCiAgICAgICAgfSkKICAgICAgICByZXN1bHQudGhlbihmdW5jdGlvbigpIHsKICAgICAgICAgIHNlbGYuJHJvdXRlci5nbyh7cGF0aDogc2VsZi4kcm91dGVyLmN1cnJlbnRSb3V0ZS5wYXRoLCBmb3JjZTogdHJ1ZX0pIC8vIOODquODreODvOODiQogICAgICAgIH0pCiAgICAgIH0KCgoKICAgIH0sCiAgICBzZWFyY2hNeVJlc2VydmF0aW9uKCkgeyAvLyDoh6rliIbjga7kuojntITjgYzjgYLjgovjgYvoqr/jgbnjgosKICAgICAgbGV0IGRhdGFiYXNlID0gZmlyZWJhc2UuZGF0YWJhc2UoKQogICAgICBsZXQgbXlVaWQgPSBmaXJlYmFzZS5hdXRoKCkuY3VycmVudFVzZXIudWlkCiAgICAgIGxldCBub3cgPSBuZXcgRGF0ZSgyMDIwLDEsNikvL25ldyBEYXRlKCkKICAgICAgY29uc29sZS5sb2cobm93KQogICAgICBsZXQgd2VlayA9IFsiTW9uIiwiVHVlIiwiV2VkIiwiVGh1IiwiRnJpIl0KCgogICAgICBpZiAobm93LmdldERheSgpICE9IDAgJiYgbm93LmdldERheSgpICE9IDYpIHsKICAgICAgICBsZXQgZGF5T2ZXZWVrID0gd2Vla1tub3cuZ2V0RGF5KCktMV0KCiAgICAgICAgbGV0IHJlc2VydmF0aW9uID0gZGF0YWJhc2UucmVmKGBzZWF0cy8ke2RheU9mV2Vla31gKQoKICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSkgewogICAgICAgICAgcmVzZXJ2YXRpb24ub24oJ3ZhbHVlJywgKHNuYXBzaG90KT0+IHsKICAgICAgICAgICAgbGV0IHZhbCA9IHNuYXBzaG90LnZhbCgpCiAgICAgICAgICAgIGxldCBzZWF0ID0gIm5pbCIKCiAgICAgICAgICAgIHNlYXJjaF9sb29wOgogICAgICAgICAgICBmb3IgKGxldCBpPTA7IGk8MTU7IGkrKykgewogICAgICAgICAgICAgIGZvciAobGV0IGo9MDsgajw2OyBqKyspIHsKICAgICAgICAgICAgICAgIGlmICh2YWxbaV1bal0gPT0gbXlVaWQpIHsKICAgICAgICAgICAgICAgICAgc2VhdCA9IGkKICAgICAgICAgICAgICAgICAgYnJlYWsgc2VhcmNoX2xvb3AKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmVzb2x2ZShzZWF0KQogICAgICAgICAgfSkKICAgICAgICB9KQogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlKSB7CiAgICAgICAgICBjb25zb2xlLmxvZygn5LuK5pel44Gv55m75qCh5pel44Gn44Gv44GC44KK44G+44Gb44KTJykKICAgICAgICAgIHJlc29sdmUoJ+mdnueZu+agoeaXpScpCiAgICAgICAgfSkKICAgICAgfQoKICAgIH0sCiAgICBnZXRNeU51bWJlckRhdGEoYXR0ZW5kYW5jZURhdGEpIHsgLy8g6Ieq5YiG44Gu55Wq5Y+344Gu44OH44O844K/44KS6L+U44GZCiAgICAgIGxldCBteVVpZCA9IGZpcmViYXNlLmF1dGgoKS5jdXJyZW50VXNlci51aWQKCiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlKSB7CiAgICAgICAgZm9yIChsZXQga2V5IGluIGF0dGVuZGFuY2VEYXRhKSB7CiAgICAgICAgICBpZiAoYXR0ZW5kYW5jZURhdGFba2V5XVsndWlkJ10gPT0gbXlVaWQpIHsKICAgICAgICAgICAgcmVzb2x2ZShrZXkpCiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KQogICAgfQogIH0KfQo="},{"version":3,"sources":["IssueNumber.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"IssueNumber.vue","sourceRoot":"src/components","sourcesContent":["<template lang=\"html\">\n  <div>\n    <NavigationDrawer/>\n\n    <v-content>\n      <v-snackbar\n        v-model=\"snackbar\"\n        top\n        right\n      >\n        あなたは今日登校できません\n        <v-btn\n          color=\"pink\"\n          text\n          @click=\"snackbar = false\"\n        >\n          Close\n        </v-btn>\n      </v-snackbar>\n\n      <Indeterminate v-if=\"loading\"/>\n      <div v-else>\n        <div v-if=\"haveNumber\" class=\"mt-12\">\n          <h1 class=\"text-center headline\">あなたの登校番号: {{ myNumber }}</h1>\n\n        </div>\n        <div v-else class=\"mt-12\">\n\n          <div v-if=\"attendance\">\n            <h1 class=\"text-center headline\">あなたはもう登校済みです</h1>\n            <v-row :justify=\"'center'\">\n              <v-col cols=\"11\">\n                <NowSeatWrapCard/>\n              </v-col>\n            </v-row>\n          </div>\n\n          <div v-else>\n\n\n            <h1 class=\"text-center headline\">あなたの番号は存在しませんでした</h1>\n            <h1 class=\"text-center\">↓ボタンを押して番号を作って↓</h1>\n\n            <v-row class=\"mt-12\" :justify=\"'center'\">\n\n              <v-tooltip v-model=\"show\" top>\n                <template v-slot:activator=\"{ on }\">\n                  <v-btn outlined x-large fab color=\"cyan\" v-on=\"on\" @click=\"makeNumber()\">\n                    <v-icon>mdi-ticket-account</v-icon>\n                  </v-btn>\n                </template>\n                <span>登校する！</span>\n              </v-tooltip>\n\n            </v-row>\n\n          </div>\n\n        </div>\n      </div>\n\n\n    </v-content>\n  </div>\n\n</template>\n\n<script>\nimport firebase from 'firebase/app'\nimport 'firebase/database'\nimport 'firebase/storage'\nimport NavigationDrawer from './NavigationDrawer'\nimport Indeterminate from './Indeterminate'\nimport NowSeatWrapCard from './NowSeatWrapCard'\n\nexport default {\n  data() {\n    return {\n      loading: true,\n      show: false,\n      haveNumber: false,\n      attendance: false, // 登校済みかどうか\n      myNumber: '',\n      realName: '',\n      snackbar: false\n    }\n  },\n  components: {\n    NavigationDrawer,\n    Indeterminate,\n    NowSeatWrapCard\n  },\n  created() {\n    this.init()\n  },\n  methods: {\n    async init() {\n      let attendanceData = await this.getAttendanceData()\n      console.debug(attendanceData)\n      if (await this.searchMyNumber(attendanceData)) {\n        console.debug(\"自分の番号が存在しました\")\n        this.haveNumber = true\n        let myNumber = await this.getMyNumberData(attendanceData)\n        this.myNumber = myNumber\n      } else if (await this.searchMyuidNow()) {\n        console.debug(\"お前もう学校おるやんけ\")\n        this.attendance = true\n      } else {\n        console.debug(\"自分の番号がありませんでした\")\n      }\n\n      this.loading = false\n\n    },\n    getAttendanceData() { // attendanceのデータを連想配列でとってくる\n      let database = firebase.database()\n      let attendance = database.ref('attendance')\n      let self = this\n      return new Promise(function(resolve) {\n        attendance.on('value', (snapshot)=> {\n          let val = snapshot.val()\n          delete val['nil'] // 空データの削除\n          self.attendanceData = val\n          resolve(val)\n        })\n      })\n    },\n    searchMyNumber(attendanceData) { // attendanceDataのなかに自分の番号があるかしらべる\n      let myUid = firebase.auth().currentUser.uid\n\n      return new Promise(function(resolve) {\n        for (let key in attendanceData) {\n          if (attendanceData[key]['uid'] == myUid) {\n            resolve(true)\n          }\n        }\n        resolve(false)\n      })\n    },\n    searchMyuidNow() { // 今の席(now)のデータに自分のuidが存在するか調べる(登校済みかしらべる)\n      let database = firebase.database()\n      let myUid = firebase.auth().currentUser.uid\n\n      // Nowの取得\n      return new Promise(function(resolve) {\n        let now = database.ref('/seats/Now')\n        now.on('value', (snapshot)=> {\n          let val = snapshot.val()\n          let answer = false\n\n          // 検索かいし\n          search_loop:\n          for (let i=0; i<15; i++) {\n            for (let j=0; j<6; j++) {\n              if (val[i][j] == myUid) {\n                answer = true\n                break search_loop\n              }\n            }\n          }\n          resolve(answer)\n        })\n      })\n    },\n    async makeNumber() { // 自分の番号を作る\n      // 今の番号一覧と被らない乱数を作る\n      let attendanceData = await this.getAttendanceData()\n      let random = 0\n      let loop = true\n      while (loop) {\n        let branch = true\n        random = Math.floor( Math.random() * 900000 ) + 100000; // 100000~999999の乱数を生成\n        for (let key in attendanceData) {\n          if (random == key) {\n            branch = false\n            break\n          }\n        }\n        if (branch) {\n          // 重ならなかった時の処理\n          this.setNumber(random)\n          loop = false\n        }\n      }\n    },\n    async setNumber(number) { // 番号の設定関数\n      let self = this\n      console.debug(\"setNumber\",number)\n      let seat = await this.searchMyReservation()\n      if (seat == \"非登校日\") {\n        this.snackbar = true\n      } else {\n        console.debug(seat)\n\n        // 1分後の時間を生成\n        let timeLimit = new Date()\n        timeLimit.setMinutes(timeLimit.getMinutes() + 1)\n        console.debug('timeLimit', timeLimit)\n\n        let database = firebase.database()\n\n        let result = new Promise(function(resolve) {\n          database.ref(`attendance/${number}`).set({'uid': firebase.auth().currentUser.uid,\n                                                    'seat': seat,\n                                                    'timeLimit': {Hours: timeLimit.getHours(),\n                                                                  Minutes: timeLimit.getMinutes()}\n                                                  })\n          resolve()\n        })\n        result.then(function() {\n          self.$router.go({path: self.$router.currentRoute.path, force: true}) // リロード\n        })\n      }\n\n\n\n    },\n    searchMyReservation() { // 自分の予約があるか調べる\n      let database = firebase.database()\n      let myUid = firebase.auth().currentUser.uid\n      let now = new Date(2020,1,6)//new Date()\n      console.log(now)\n      let week = [\"Mon\",\"Tue\",\"Wed\",\"Thu\",\"Fri\"]\n\n\n      if (now.getDay() != 0 && now.getDay() != 6) {\n        let dayOfWeek = week[now.getDay()-1]\n\n        let reservation = database.ref(`seats/${dayOfWeek}`)\n\n        return new Promise(function(resolve) {\n          reservation.on('value', (snapshot)=> {\n            let val = snapshot.val()\n            let seat = \"nil\"\n\n            search_loop:\n            for (let i=0; i<15; i++) {\n              for (let j=0; j<6; j++) {\n                if (val[i][j] == myUid) {\n                  seat = i\n                  break search_loop\n                }\n              }\n            }\n            resolve(seat)\n          })\n        })\n      } else {\n        return new Promise(function(resolve) {\n          console.log('今日は登校日ではありません')\n          resolve('非登校日')\n        })\n      }\n\n    },\n    getMyNumberData(attendanceData) { // 自分の番号のデータを返す\n      let myUid = firebase.auth().currentUser.uid\n\n      return new Promise(function(resolve) {\n        for (let key in attendanceData) {\n          if (attendanceData[key]['uid'] == myUid) {\n            resolve(key)\n          }\n        }\n      })\n    }\n  }\n}\n</script>\n\n<style lang=\"css\" scoped>\n</style>\n"]}]}